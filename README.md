Движок для гипертекстовых игр на базе локаций, персонажей, квестов и предметов с инвентарем

### Совместимость
IE 11+, Firefox 56+, Chrome

## Возможности

* Сборка игры из локаций с постоянным описанием и переменной частью, которая генерится из предметов

* предметы в игре, которые можно переносить из локации в локацию с помощью инвентаря

* персонажи, которые могут случайно бродить между локациями и иметь свой инвентарь

### Сделано
* Разбивка исходного текста на "узлы" с помощью \# в начале строки
* комменты в исходнике
* title для длинного описания локации, \# для краткого нейминга
* Обработка нажатий на View
* Парсинг переходов между локациями
* Парсинг просто параметров с типами из исходника
* Чтение игры из локального файла - для дистрибутива простых людей
* Шаблон View и сменный CSS шаблона
* CSS локации - подключение по переменным

### В процессе
* автовывод параметров
* метаданные локации


## To Do
* Перезапуск игры командой выбора
* условия с параметрами
* изменение параметров
* КАК ВЫВОДИТЬ параметры на экран - как числа
* КАК ВЫВОДИТЬ параметры на экран - как произвольную графику
* [параметры](PARAMS.md "Перейти к описанию параметров" )
* инвентарь / предметы
* персонажи
* квесты
* история локаций? / или тайный инвентарь?
* показ предыдущих N выборов, как в Torment Tides of Numenera
* разметка шаблона

### Локации

* Основной элемент игры. Аналог "узла" в гипертексте.
* Локация содержит описание, название и контент
* контент состоит из переходов в другие локации, предметов и персонажей
* если какая-то локация указывает на переход в другую локацию - в той локации должен автоматически генерироваться обратный переход, если не указана особая опция (односторонний переход)
* одна локация объявляется стартовой. По умолчанию таковой является первая локация в исходном тексте игры
* в стартовой локации можно перечислить в контенте другие локации - и они автоматически соединятся обратными переходами. Так можно делать "хабы" из кучи локаций, не заботясь о прописывании всех переходов.
* из "хаба" разумеется можно указывать на другой "хаб", на любую другую локацию, предмет или персонаж

## Формат для описания игры

\// **Двойной слэш**. Комментарий. Не используется в игре. Комментарием считается все после двойного слэша.

\# **Решетка**. Начало данных о локации. Текст на одной строке с решеткой определяется как название локации.

\: **Двоеточие**. В строке названии локации  - начало расширенного заголовка локации. В строке выбора - начало описания выбора. Примеры:

```text
# traktir: Трактир Пивной Сом
```

```text
* street: Выйти на улицу
```


Строки между названием и выборами определяются как текст локации.

\* **Звездочка**. Выбор, формат которого задается как 

``* choiceText [location]``

где choiceText - текст, который видит пользователь, а location - id локации, к которой происходит переход


## Функции 
В конфиге игры можно задать ссылку на файл функций, которые можно определять в игре. Это JavaScript-файл в котором описан объект GameFunc

```javascript
var GameFunc = {
    // записываем параметры через this.
    // как только функция применяется - параметр появляется
    // имена функций не должны совпадать с именами параметров
    spiritChange: function (value) {
        this.spirit += value;
    },
    
    intellectChange: function(value){
        this.intellect += value;
    },

    // в этом же объекте можно задавать параметры как поля
    someParam: 12, // добавили параметр с именем someParam и значением 12

    someParamChange: function (value) { // теперь можем вызывать эту функцию, чтобы менять параметр
        this.someParam += value;
    }	
};
```

Имя объекта всегда должно быть `GameFunc`. Внутри него как поля можно задать сколько угодно функций, которые можно использовать в игре. 

Внутри функции для обращения к параметру игры следует всегда использовать приставку `this.`

### Автолинк локаций в хабе

Если после заголовка узла-локации поставить спецпараметр `@hub`, то все узлы, на которые можно перейти из этой локации, автоматически получат обратно ссылку на ней. Это удобно для создания "хабов" - то есть узлов, из которых есть выход во множество узлов, из которых можно возвращаться обратно

```text
# start: Начало игры
@hub Начать игру заново
Вы стоите в центре лабиринта

* mino: Пойти в комнату с минотавром
* trap: Спуститься вниз
* left: Пойти налево
* right: Пойти направо
```

Во все указанные локации - теперь добавится обратная ссылка.

Если вы хотите сделать один или несколько переходов в хабе безвозвратным используйте маркер `@oneway` в строке выбора. Пример:  

```text
# start: Начало игры
@hub Начать игру заново
Вы стоите в центре лабиринта

* mino: Пойти в комнату с минотавром @oneway
* trap: Спуститься вниз
* left: Пойти налево
* right: Пойти направо
```

Теперь из комнаты с минотавром нет возврата - если только вы не пропишете её там вручную.